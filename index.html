<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>숭실대학교 학식 메뉴 (Apple Design)</title>
  <style>
    /* 1. CSS Variables (Apple-inspired Design System) */
    :root {
      --bg-color: #f5f5f7;
      --card-bg-color: #ffffff;
      --text-primary: #1d1d1f;
      --text-secondary: #6e6e73;
      --border-color: #d2d2d7;
      --pill-bg-color: #e8e8ea;
      --rating-color: #ffb400;
      --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      --card-border-radius: 16px;
    }

    /* 2. Global Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-family);
      background-color: var(--bg-color);
      color: var(--text-primary);
    }

    /* 3. Layout */
    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 20px;
    }

    header {
      background: rgba(245, 245, 247, 0.7);
      backdrop-filter: saturate(180%) blur(20px);
      -webkit-backdrop-filter: saturate(180%) blur(20px);
      position: sticky;
      top: 0;
      z-index: 10;
      padding: 24px 0 16px 0;
      text-align: center;
      margin-bottom: 32px;
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      letter-spacing: -0.5px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
    }

    h1 svg {
      width: 36px;
      height: 36px;
    }

    .date-info {
      font-size: 1.1rem;
      color: var(--text-secondary);
      margin-top: 8px;
    }

    .restaurant-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 25px;
    }

    /* 4. Components */
    .restaurant-card {
      background: var(--card-bg-color);
      border-radius: var(--card-border-radius);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      overflow: hidden;
      transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    }

    .restaurant-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }

    .restaurant-header {
      padding: 20px;
      border-bottom: 1px solid var(--border-color);
    }

    .restaurant-name {
      font-size: 1.5rem;
      font-weight: 600;
    }

    .restaurant-location {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-top: 4px;
    }

    .restaurant-body {
      padding: 20px;
    }

    .menu-section {
      padding-bottom: 20px;
      margin-bottom: 20px;
      border-bottom: 1px solid #f0f0f2;
    }
    .menu-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }

    .corner-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .corner-name {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .main-menu {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }

    .menu-details { flex: 1; }
    .menu-name { font-size: 1.05rem; }
    .menu-name-en { font-size: 0.9rem; color: var(--text-secondary); margin-top: 4px; }

    .rating {
      display: flex;
      align-items: center;
      gap: 4px;
      color: var(--text-primary);
      font-weight: 600;
      white-space: nowrap;
    }

    .star { color: var(--rating-color); }

    .side-items-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .pill {
      display: inline-block;
      font-size: 0.85rem;
      font-weight: 500;
      padding: 6px 12px;
      border-radius: 20px;
      background-color: var(--pill-bg-color);
      color: var(--text-secondary);
    }
    .pill.meal-badge {
      font-weight: 600;
      color: var(--text-primary);
    }
    .pill.breakfast { background-color: #fff0d1; }
    .pill.lunch { background-color: #d7f5e3; }
    .pill.dinner { background-color: #d4e8ff; }


    /* 5. Status Messages */
    .status-container {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-secondary);
      font-size: 1.1rem;
    }

    @media (max-width: 768px) {
      h1 { font-size: 2rem; }
      .restaurant-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
<div class="container">
  <header>
    <h1>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15.59V16h-1.5c-.28 0-.5-.22-.5-.5s.22-.5.5-.5H11v-1.09c0-.28.22-.5.5-.5s.5.22.5.5V15h1.5c.28 0 .5.22.5.5s-.22.5-.5.5H12v1.59c0 .28-.22.5-.5.5s-.5-.22-.5-.5zM12 12c-1.38 0-2.5-1.12-2.5-2.5S10.62 7 12 7s2.5 1.12 2.5 2.5S13.38 12 12 12z"/>
        <path d="M21.5 12.5c-.28 0-.5-.22-.5-.5v-1.5H19.5c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1.5V8.41c0-.28.22-.5.5-.5s.5.22.5.5v1.59h1.5c.28 0 .5.22.5.5s-.22.5-.5.5h-1.5v1.5c0 .28-.22.5-.5.5zM4.5 11.5c.28 0 .5.22.5.5v1.5h1.5c.28 0 .5.22.5.5s-.22.5-.5.5H5v1.59c0 .28-.22.5-.5.5s-.5-.22-.5-.5V15H2.5c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1.5v-1.5c0-.28.22-.5.5-.5z"/>
      </svg>
      숭실대학교 학식 메뉴
    </h1>
    <div class="date-info" id="dateInfo"></div>
  </header>

  <div id="statusContainer" class="status-container">
    <div id="statusMessage">메뉴 정보를 불러오는 중...</div>
  </div>

  <div id="restaurantGrid" class="restaurant-grid" style="display: none;"></div>
</div>

<script>
  async function loadMenus() {
    const statusContainer = document.getElementById('statusContainer');
    const statusMessage = document.getElementById('statusMessage');
    const grid = document.getElementById('restaurantGrid');

    try {
      const response = await fetch('./menus.json');
      if (!response.ok) {
        throw new Error(`메뉴 파일을 불러올 수 없습니다 (HTTP ${response.status})`);
      }
      const data = await response.json();

      statusContainer.style.display = 'none';
      grid.style.display = 'grid';
      displayMenus(data);

    } catch (error) {
      console.error('Error loading menus:', error);
      statusMessage.textContent = '메뉴 정보를 불러오는 데 실패했습니다. 파일 경로와 형식을 확인해주세요.';
    }
  }

  function displayMenus(data) {
    const dateInfo = document.getElementById('dateInfo');
    const date = new Date(data.date);
    const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
    dateInfo.textContent = date.toLocaleDateString('ko-KR', options);

    const grid = document.getElementById('restaurantGrid');
    grid.innerHTML = '';

    for (const place of Object.values(data.places)) {
      grid.appendChild(createRestaurantCard(place));
    }
  }

  function createRestaurantCard(place) {
    const card = document.createElement('div');
    card.className = 'restaurant-card';

    let bodyContent = '';
    if (place.menus.length === 0) {
      bodyContent = '<div class="status-container">오늘은 운영하지 않습니다.</div>';
    } else {
      bodyContent = place.menus.map(createMenuSection).join('');
    }

    card.innerHTML = `
      <div class="restaurant-header">
        <div class="restaurant-name">${place.name}</div>
        <div class="restaurant-location">${place.building} ${place.location_detail}</div>
      </div>
      <div class="restaurant-body">
        ${bodyContent}
      </div>
    `;
    return card;
  }

  function createMenuSection(menu) {
    let mealClass = '';
    if (menu.meal === '조식') mealClass = 'breakfast';
    else if (menu.meal === '석식') mealClass = 'dinner';
    else mealClass = 'lunch';

    const mainMenuItem = menu.items[0] || { name: '메뉴 정보 없음' };

    const sideItems = menu.items.slice(1).map(item =>
            `<span class="pill">${item.name}</span>`
    ).join('');

    const ratingHtml = mainMenuItem.rating ? `
      <div class="rating">
        <span class="star">★</span>
        <span>${mainMenuItem.rating}</span>
      </div>
    ` : '';

    return `
      <div class="menu-section">
        <div class="corner-header">
          <div class="corner-name">${menu.corner}</div>
          <div class="pill meal-badge ${mealClass}">${menu.meal}</div>
        </div>
        <div class="main-menu">
          <div class="menu-details">
            <div class="menu-name">${mainMenuItem.name}</div>
            ${mainMenuItem.name_en ? `<div class="menu-name-en">${mainMenuItem.name_en}</div>` : ''}
          </div>
          ${ratingHtml}
        </div>
        ${sideItems ? `<div class="side-items-container">${sideItems}</div>` : ''}
      </div>
    `;
  }

  window.addEventListener('DOMContentLoaded', loadMenus);
</script>
</body>
</html>